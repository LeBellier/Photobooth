#parse("camera/head.vm")
#macro(showSettingSelector $cameraConfig $settingKey)
	#set($configEntry = $cameraConfig.get($settingKey))
	<div class="scroll">
		<div><span class="headline">$configEntry.label</span></div>
		<div><span class="smallest">(<span>$configEntry.type.name()</span>: <span>$configEntry.key</span>)</span></div>
		<div>
			#if($!configEntry.printableValue)
				<div>$!configEntry.printableValue</div>
			#end
			#if($configEntry.type.name().equalsIgnoreCase("radio") || $configEntry.type.name().equalsIgnoreCase("menu"))
				<select class="eightyPercentWidth" onchange="javascript:onsettingchange('$configEntry.type.name()', '$settingKey', this.options[this.selectedIndex].value)">
					#foreach($choice in $configEntry.choices)
						#set($count = $velocityCount - 1)
						<option value="${count}"
							#if($configEntry.value.toString().equals($choice.toString()))
								selected="selected"
							#end
						>$choice</option>
					#end
				</select>
			#elseif($configEntry.type.name().equalsIgnoreCase("toggle"))
				#set($choices = {"2":"--", "0":"Off", "1":"On"})
				<select class="eightyPercentWidth" onchange="javascript:onsettingchange('$configEntry.type.name()', '$settingKey', this.options[this.selectedIndex].value)">
					#foreach($choice in $choices.entrySet())
						<option value="$!choice.key"
							#if($configEntry.value.toString().equals($choice.key.toString()))
								selected="selected"
							#end
						>$!choice.value</option>
					#end
				</select>
			#elseif($configEntry.type.name().equalsIgnoreCase("text") || $configEntry.type.name().equalsIgnoreCase("date"))
				#set($inputId = "settingInput_$settingKey.replaceAll('/', '_')")
				<input type="button" value="Set" onclick="javascript:onsettingchange('$configEntry.type.name()', '$settingKey', document.getElementById('$inputId').value)" />
				<input class="eightyPercentWidth" type="text" id="$inputId" value="$!configEntry.value.toString()" />
			#end
		</div>
	</div>
#end
<script>
	function onsettingchange(type, key, value) {
		document.forms["setsettingform"]["type"].value=type;
		document.forms["setsettingform"]["key"].value=key;
		document.forms["setsettingform"]["value"].value=value;
		document.forms["setsettingform"].submit();
	}
</script>
<div class="fullWidth">
	<form id="setsettingform" action="/allsettingset" method="POST" style="display: none">
		<input type="hidden" name="type" />
		<input type="hidden" name="key" />
		<input type="hidden" name="value" />
	</form>
	<div class="pageHead">Camera Control</div>
	<div class="pageSubHead">
		#parse("camera/navigation.vm")
	</div>
	<div class="pageContent">
	#*
		<div>
			<div>Camera: $!{cameraConfig.get("/main/status/cameramodel").value}</div>
			<div>Lens: $!{cameraConfig.get("/main/status/lensname").value}</div>
		</div>
		<hr/>
		<div>
			<div>Battery: $!{cameraConfig.get("/main/status/batterylevel").value}</div>
			<div>Available shots: $!{cameraConfig.get("/main/status/availableshots").value}</div>
			<div>Shutter counter: $!{cameraConfig.get("/main/status/shuttercounter").value}</div>
		</div>
		<hr/>
		<div>
			#showSettingSelector($cameraConfig "/main/capturesettings/shutterspeed")
			#showSettingSelector($cameraConfig "/main/capturesettings/aperture")
			#showSettingSelector($cameraConfig "/main/imgsettings/iso")
			#showSettingSelector($cameraConfig "/main/settings/reviewtime")
			#showSettingSelector($cameraConfig "/main/imgsettings/whitebalance")
			#showSettingSelector($cameraConfig "/main/capturesettings/drivemode")
			#showSettingSelector($cameraConfig "/main/capturesettings/meteringmode")
			#showSettingSelector($cameraConfig "/main/capturesettings/focusmode")
			#showSettingSelector($cameraConfig "/main/capturesettings/picturestyle")
			#showSettingSelector($cameraConfig "/main/imgsettings/imageformat")
			#showSettingSelector($cameraConfig "/main/imgsettings/colorspace")
		</div>
		<hr/>
	*#
		<div>
			#foreach($settingEntry in $cameraConfig.entrySet())
				#showSettingSelector($cameraConfig $settingEntry.key)
				<hr/>
			#end
		</div>
	</div>
	<div style="display: none">
		$cameraConfig
	</div>	
</div>
#parse("camera/foot.vm")
